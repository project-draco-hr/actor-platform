{
  this.application=application;
  Fresco.initialize(application);
  AndroidContext.setContext(application);
  new SmileProcessor(application).loadEmoji();
  ConfigurationBuilder builder=new ConfigurationBuilder();
  for (  String s : endpoints) {
    builder.addEndpoint(s);
  }
  builder.setPhoneBookProvider(new AndroidPhoneBook());
  builder.setNotificationProvider(new AndroidNotifications(AndroidContext.getContext()));
  builder.setDeviceCategory(DeviceCategory.MOBILE);
  builder.setPlatformType(PlatformType.ANDROID);
  builder.setApiConfiguration(new ApiConfiguration(appName,apiAppId,apiAppKey,Devices.getDeviceName(),AndroidContext.getContext().getPackageName() + ":" + Build.SERIAL));
  Locale defaultLocale=Locale.getDefault();
  Log.d(TAG,"Found Locale: " + defaultLocale.getLanguage() + "-"+ defaultLocale.getCountry());
  Log.d(TAG,"Found Locale: " + defaultLocale.getLanguage());
  builder.addPreferredLanguage(defaultLocale.getLanguage() + "-" + defaultLocale.getCountry());
  builder.addPreferredLanguage(defaultLocale.getLanguage());
  String timeZone=TimeZone.getDefault().getID();
  Log.d(TAG,"Found TimeZone: " + timeZone);
  builder.setTimeZone(timeZone);
  this.messenger=new AndroidMessenger(AndroidContext.getContext(),builder.build());
  if (isKeepAliveEnabled) {
    Intent keepAliveService=new Intent(application,KeepAliveService.class);
    PendingIntent pendingIntent=PendingIntent.getService(application,0,keepAliveService,0);
    AlarmManager alarm=(AlarmManager)application.getSystemService(Context.ALARM_SERVICE);
    alarm.setRepeating(AlarmManager.RTC,System.currentTimeMillis(),30 * 1000,pendingIntent);
  }
  try {
    final ActorPushManager pushManager=(ActorPushManager)Class.forName("im.actor.push.PushManager").newInstance();
    if (pushId != 0) {
      pushManager.registerPush(application);
    }
  }
 catch (  ClassNotFoundException e) {
    e.printStackTrace();
  }
catch (  InstantiationException e) {
    e.printStackTrace();
  }
catch (  IllegalAccessException e) {
    e.printStackTrace();
  }
}
