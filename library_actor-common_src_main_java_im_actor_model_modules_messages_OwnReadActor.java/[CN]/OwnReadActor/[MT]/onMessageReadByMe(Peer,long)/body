{
  long msgSortingDate=0;
  Set<UnreadMessage> unread=messagesStorage.getUnread(peer);
  for (  UnreadMessage u : unread.toArray(new UnreadMessage[0])) {
    if (u.getSortDate() <= sortingDate && u.getSortDate() > msgSortingDate) {
      msgSortingDate=u.getSortDate();
    }
  }
  if (msgSortingDate > 0) {
    onMessageRead(peer,msgSortingDate);
  }
}
