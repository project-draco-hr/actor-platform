{
  if (message instanceof Message) {
    onInMessage((Message)message);
  }
 else   if (message instanceof MessageRead) {
    onMessagePlainRead(((MessageRead)message).getDate());
  }
 else   if (message instanceof MessageEncryptedRead) {
    onMessageEncryptedRead(((MessageEncryptedRead)message).getRid());
  }
 else   if (message instanceof MessageReceived) {
    onMessagePlainReceived(((MessageReceived)message).getDate());
  }
 else   if (message instanceof MessageEncryptedReceived) {
    onMessageEncryptedReceived(((MessageEncryptedReceived)message).getRid());
  }
 else   if (message instanceof HistoryLoaded) {
    onHistoryLoaded(((HistoryLoaded)message).getMessages());
  }
 else {
    drop(message);
  }
}
