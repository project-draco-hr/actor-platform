{
  return new Command<Integer>(){
    @Override public void start(    final CommandCallback<Integer> callback){
      ArrayList<UserOutPeer> peers=new ArrayList<UserOutPeer>();
      for (      int u : uids) {
        User user=users().getValue(u);
        if (user != null) {
          peers.add(new UserOutPeer(u,user.getAccessHash()));
        }
      }
      final long rid=RandomUtils.nextRid();
      request(new RequestCreateGroup(rid,title,peers),new RpcCallback<ResponseCreateGroup>(){
        @Override public void onResult(        ResponseCreateGroup response){
          List<Member> members=new ArrayList<Member>();
          for (          int u : uids) {
            members.add(new Member(u,myUid(),response.getDate(),u == myUid()));
          }
          final im.actor.core.api.Group group=new im.actor.core.api.Group(response.getGroupPeer().getGroupId(),response.getGroupPeer().getAccessHash(),title,null,true,myUid(),members,response.getDate(),null,null,null,null,null,true,null,null);
          ArrayList<im.actor.core.api.Group> groups=new ArrayList<im.actor.core.api.Group>();
          groups.add(group);
          updates().onFatSeqUpdateReceived(response.getSeq(),response.getState(),new UpdateGroupInvite(group.getId(),rid,myUid(),response.getDate()),new ArrayList<im.actor.core.api.User>(),groups);
          updates().executeAfter(response.getSeq(),new Runnable(){
            @Override public void run(){
              if (avatarDescriptor != null) {
                changeAvatar(group.getId(),avatarDescriptor);
              }
              runOnUiThread(new Runnable(){
                @Override public void run(){
                  callback.onResult(group.getId());
                }
              }
);
            }
          }
);
        }
        @Override public void onError(        final RpcException e){
          runOnUiThread(new Runnable(){
            @Override public void run(){
              callback.onError(e);
            }
          }
);
        }
      }
);
    }
  }
;
}
