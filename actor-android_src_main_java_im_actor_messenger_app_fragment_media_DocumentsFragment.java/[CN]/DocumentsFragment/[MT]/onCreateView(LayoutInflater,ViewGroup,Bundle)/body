{
  chatType=getArguments().getInt("CHAT_TYPE");
  chatId=getArguments().getInt("CHAT_ID");
  ListEngine<Document> engine=ListEngines.getDocuments(DialogUids.getDialogUid(chatType,chatId));
  documentList=new EngineUiList<Document>(engine);
  View res=inflater.inflate(R.layout.fragment_doc,container,false);
  emptyView=res.findViewById(R.id.noDocs);
  emptyView.setVisibility(View.GONE);
  listView=(ListView)res.findViewById(R.id.docsList);
  adapter=new DocumentAdapter(documentList,getActivity());
  View footer=inflater.inflate(R.layout.adapter_doc_footer,listView,false);
  listView.addFooterView(footer,null,false);
  listView.setAdapter(adapter);
  listView.setOnItemClickListener(new AdapterView.OnItemClickListener(){
    @Override public void onItemClick(    AdapterView<?> parent,    View view,    int position,    long id){
      Document doc=(Document)parent.getItemAtPosition(position);
      Downloaded d=downloaded().get(doc.getFileLocation().getFileId());
      if (d != null) {
        getActivity().startActivity(Intents.openDoc(d));
      }
    }
  }
);
  isInit=true;
  getBinder().bind(documentList.getListState(),new Listener<ListState>(){
    @Override public void onUpdated(    ListState listState){
switch (listState.getState()) {
case LOADING_EMPTY:
        break;
case LOADED_EMPTY:
      showView(emptyView,!isInit,false);
    goneView(listView,!isInit,false);
  break;
case LOADED:
default :
goneView(emptyView,!isInit,false);
showView(listView,!isInit,false);
break;
}
}
}
);
isInit=false;
return res;
}
