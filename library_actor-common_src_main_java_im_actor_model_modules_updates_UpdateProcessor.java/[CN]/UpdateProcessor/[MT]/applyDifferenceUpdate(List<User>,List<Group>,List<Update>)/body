{
  applyRelated(users,groups,false);
  int messageResumeNotificationsIndex=-1;
  Update m;
  for (int i=updates.size() - 1; i >= 0; i--) {
    m=updates.get(i);
    if (m instanceof UpdateMessage)     messageResumeNotificationsIndex=i;
  }
  if (messageResumeNotificationsIndex != -1)   modules().getNotifications().pauseNotifications();
  Update u;
  for (int i=0; i < updates.size(); i++) {
    u=updates.get(i);
    if (i == messageResumeNotificationsIndex)     u.setIsLastInDiff(true);
    processUpdate(u);
  }
  applyRelated(users,groups,true);
}
