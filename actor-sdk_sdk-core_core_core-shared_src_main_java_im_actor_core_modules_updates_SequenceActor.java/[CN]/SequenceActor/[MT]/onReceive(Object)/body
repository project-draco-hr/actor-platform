{
  if (message instanceof Invalidate || message instanceof SeqUpdateTooLong || message instanceof ForceInvalidate) {
    invalidate();
  }
 else   if (message instanceof SeqUpdate || message instanceof FatSeqUpdate) {
    onUpdateReceived(message);
  }
 else   if (message instanceof WeakUpdate) {
    onWeakUpdateReceived((WeakUpdate)message);
  }
 else   if (message instanceof InternalUpdate) {
    onInternalUpdateReceived((InternalUpdate)message);
  }
 else   if (message instanceof ExecuteAfter) {
    onExecuteAfterReceived((ExecuteAfter)message);
  }
 else   if (message instanceof PushSeq) {
    onPushSeqReceived(((PushSeq)message).seq);
  }
 else   if (message instanceof UpdateProcessed) {
    Log.d(TAG,"Ending stashing");
    endStash();
  }
 else {
    drop(message);
  }
}
