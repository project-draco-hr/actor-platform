{
  super.onCreate(savedInstanceState);
  getWindow().setBackgroundDrawable(new ColorDrawable(ActorSDK.sharedActor().style.getMainBackgroundColor()));
  setContentView(R.layout.activity_dialog);
  setFragment(savedInstanceState);
  ActorStyle style=ActorSDK.sharedActor().style;
  FrameLayout messageContainer=(FrameLayout)findViewById(R.id.fl_send_panel);
  messageContainer.setBackgroundColor(style.getMainBackgroundColor());
  messageEditText=(EditText)findViewById(R.id.et_message);
  messageEditText.setTextColor(style.getTextPrimaryColor());
  messageEditText.setHintTextColor(style.getTextHintColor());
  messageEditText.setOnKeyListener(new View.OnKeyListener(){
    @Override public boolean onKey(    View view,    int keycode,    KeyEvent keyEvent){
      if (messenger().isSendByEnterEnabled()) {
        if (keyEvent.getAction() == KeyEvent.ACTION_DOWN && keycode == KeyEvent.KEYCODE_ENTER) {
          onSendButtonPressed();
          return true;
        }
      }
      return false;
    }
  }
);
  messageEditText.setOnEditorActionListener(new TextView.OnEditorActionListener(){
    @Override public boolean onEditorAction(    TextView textView,    int i,    KeyEvent keyEvent){
      if (i == EditorInfo.IME_ACTION_SEND) {
        onSendButtonPressed();
        return true;
      }
      if (i == EditorInfo.IME_ACTION_DONE) {
        onSendButtonPressed();
        return true;
      }
      if (messenger().isSendByEnterEnabled()) {
        if (keyEvent != null && i == EditorInfo.IME_NULL && keyEvent.getAction() == KeyEvent.ACTION_DOWN) {
          onSendButtonPressed();
          return true;
        }
      }
      return false;
    }
  }
);
  sendButton=(TintImageView)findViewById(R.id.ib_send);
  sendButton.setResource(R.drawable.conv_send);
  sendButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      onSendButtonPressed();
    }
  }
);
  attachButton=(ImageButton)findViewById(R.id.ib_attach);
  attachButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      onAttachButtonClicked();
    }
  }
);
  removedFromGroup=findViewById(R.id.kickedFromChat);
  removedFromGroup.setBackgroundColor(ActorSDK.sharedActor().style.getMainBackgroundColor());
  ((TextView)removedFromGroup.findViewById(R.id.kicked_text)).setTextColor(style.getMainColor());
  emojiButton=(ImageView)findViewById(R.id.ib_emoji);
  emojiKeyboard=new EmojiKeyboard(this);
  emojiKeyboard.setKeyboardStatusListener(new KeyboardStatusListener(){
    @Override public void onDismiss(){
      emojiButton.setImageResource(R.drawable.ic_emoji);
    }
    @Override public void onShow(){
      emojiButton.setImageResource(R.drawable.ic_keyboard);
    }
  }
);
  emojiButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      emojiKeyboard.toggle(messageEditText);
    }
  }
);
  sendContainer=(FrameLayout)findViewById(R.id.sendContainer);
  keyboardUtils=new KeyboardHelper(this);
}
