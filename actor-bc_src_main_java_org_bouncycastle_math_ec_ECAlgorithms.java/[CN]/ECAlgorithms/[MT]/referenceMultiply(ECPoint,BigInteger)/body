{
  BigInteger x=k.abs();
  ECPoint q=p.getCurve().getInfinity();
  int t=x.bitLength();
  if (t > 0) {
    if (x.testBit(0)) {
      q=p;
    }
    for (int i=1; i < t; i++) {
      p=p.twice();
      if (x.testBit(i)) {
        q=q.add(p);
      }
    }
  }
  return k.signum() < 0 ? q.negate() : q;
}
