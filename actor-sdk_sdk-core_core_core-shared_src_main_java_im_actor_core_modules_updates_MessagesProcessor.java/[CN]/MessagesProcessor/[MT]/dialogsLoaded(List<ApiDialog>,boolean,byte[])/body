{
  ArrayList<DialogHistory> dialogs=new ArrayList<DialogHistory>();
  long maxLoadedDate=Long.MAX_VALUE;
  for (  ApiDialog dialog : apiDialogs) {
    maxLoadedDate=Math.min(dialog.getSortDate(),maxLoadedDate);
    Peer peer=convert(dialog.getPeer());
    AbsContent msgContent=null;
    try {
      msgContent=AbsContent.fromMessage(dialog.getMessage());
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
    if (msgContent == null) {
      continue;
    }
    dialogs.add(new DialogHistory(peer,dialog.getUnreadCount(),dialog.getSortDate(),dialog.getRid(),dialog.getDate(),dialog.getSenderUid(),msgContent,convert(dialog.getState())));
  }
  if (dialogs.size() > 0) {
    dialogsActor().send(new DialogsActor.HistoryLoaded(dialogs,archived));
  }
 else   if (!archived) {
    context().getAppStateModule().onDialogsLoaded();
  }
  if (!archived) {
    dialogsHistoryActor().send(new DialogsHistoryActor.LoadedMore(apiDialogs.size(),maxLoadedDate));
  }
 else {
    archivedDialogsActor().send(new ArchivedDialogsActor.LoadedMore(apiDialogs.size(),nextOffset));
  }
}
