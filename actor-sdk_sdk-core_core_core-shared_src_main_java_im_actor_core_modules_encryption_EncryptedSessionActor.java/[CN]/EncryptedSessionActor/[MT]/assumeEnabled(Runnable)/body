{
  if (theirEphermalKey0 == null) {
    Log.w(TAG,"Loading their ephemeral key0");
    request(new RequestLoadEphermalPublicKeys(new ApiUserOutPeer(uid,getUser(uid).getAccessHash()),encryptionKeyGroup.getKeyGroupId()),new RpcCallback<ResponsePublicKeys>(){
      @Override public void onResult(      ResponsePublicKeys response){
        if (response.getPublicKey().size() == 0) {
          Log.w(TAG,"No ephemeral keys found");
          return;
        }
        ApiEncryptionKey encryptionKey=response.getPublicKey().get(RandomUtils.randomId(response.getPublicKey().size()));
        theirEphermalKey0=new UserPublicKey(encryptionKey.getKeyId(),encryptionKey.getKeyAlg(),encryptionKey.getKeyMaterial());
        onOk.run();
      }
      @Override public void onError(      RpcException e){
        Log.w(TAG,"Their ephemeral error");
        Log.e(TAG,e);
      }
    }
);
    return false;
  }
  if (currentTheirKey == null) {
    Log.w(TAG,"Loading their ephemeral key");
    request(new RequestLoadEphermalPublicKeys(new ApiUserOutPeer(uid,getUser(uid).getAccessHash()),encryptionKeyGroup.getKeyGroupId()),new RpcCallback<ResponsePublicKeys>(){
      @Override public void onResult(      ResponsePublicKeys response){
        if (response.getPublicKey().size() == 0) {
          Log.w(TAG,"No ephemeral keys found");
          return;
        }
        ApiEncryptionKey encryptionKey=response.getPublicKey().get(RandomUtils.randomId(response.getPublicKey().size()));
        currentTheirKey=new UserPublicKey(encryptionKey.getKeyId(),encryptionKey.getKeyAlg(),encryptionKey.getKeyMaterial());
        onOk.run();
      }
      @Override public void onError(      RpcException e){
        Log.w(TAG,"Their ephemeral error");
        Log.e(TAG,e);
      }
    }
);
    return false;
  }
  return true;
}
