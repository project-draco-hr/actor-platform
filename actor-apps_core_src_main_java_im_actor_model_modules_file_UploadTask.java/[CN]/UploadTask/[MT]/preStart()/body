{
  fileSystemProvider=config().getFileSystemProvider();
  if (fileSystemProvider == null) {
    if (LOG) {
      Log.w(TAG,"File system is not available");
    }
    reportError();
    return;
  }
  isWriteToDestProvider=fileSystemProvider.isFsPersistent();
  downloaderProvider=config().getHttpProvider();
  if (downloaderProvider == null) {
    if (LOG) {
      Log.w(TAG,"HTTP support is not available");
    }
    reportError();
    return;
  }
  srcReference=fileSystemProvider.fileFromDescriptor(descriptor);
  if (srcReference == null) {
    if (LOG) {
      Log.d(TAG,"Error during file reference creating");
    }
    reportError();
    return;
  }
  if (isWriteToDestProvider) {
    destReference=fileSystemProvider.createTempFile();
    if (destReference == null) {
      if (LOG) {
        Log.w(TAG,"Error during file dest reference creating");
      }
      reportError();
      return;
    }
  }
  inputFile=srcReference.openRead();
  if (inputFile == null) {
    if (LOG) {
      Log.w(TAG,"Error during file open");
    }
    reportError();
    return;
  }
  if (isWriteToDestProvider) {
    outputFile=destReference.openWrite(srcReference.getSize());
    if (outputFile == null) {
      inputFile.close();
      if (LOG) {
        Log.w(TAG,"Error during dest file open");
      }
      reportError();
      return;
    }
  }
  crc32=new CRC32();
  startUpload();
}
