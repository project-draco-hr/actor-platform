{
  long oldKey;
synchronized (envelopes) {
    oldKey=topKey;
    Iterator<Map.Entry<Long,ScheduledEnvelope>> iterator=envelopes.entrySet().iterator();
    while (iterator.hasNext()) {
      if (comparator.equals(iterator.next().getValue().getEnvelope(),envelope)) {
        iterator.remove();
      }
    }
    if (envelopes.isEmpty()) {
      topKey=0;
    }
 else {
      topKey=envelopes.firstKey();
    }
  }
  if (oldKey != topKey) {
    root.changedTopKey(this);
  }
  Log.d("Envelopes#" + id,"Remove (" + topKey + "): "+ allEnvelopesDebug());
}
