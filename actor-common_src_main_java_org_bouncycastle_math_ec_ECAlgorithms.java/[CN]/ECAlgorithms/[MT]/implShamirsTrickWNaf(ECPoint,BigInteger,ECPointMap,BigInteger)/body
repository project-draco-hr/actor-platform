{
  boolean negK=k.signum() < 0, negL=l.signum() < 0;
  k=k.abs();
  l=l.abs();
  int width=Math.max(2,Math.min(16,WNafUtil.getWindowSize(Math.max(k.bitLength(),l.bitLength()))));
  ECPoint Q=WNafUtil.mapPointWithPrecomp(P,width,true,pointMapQ);
  WNafPreCompInfo infoP=WNafUtil.getWNafPreCompInfo(P);
  WNafPreCompInfo infoQ=WNafUtil.getWNafPreCompInfo(Q);
  ECPoint[] preCompP=negK ? infoP.getPreCompNeg() : infoP.getPreComp();
  ECPoint[] preCompQ=negL ? infoQ.getPreCompNeg() : infoQ.getPreComp();
  ECPoint[] preCompNegP=negK ? infoP.getPreComp() : infoP.getPreCompNeg();
  ECPoint[] preCompNegQ=negL ? infoQ.getPreComp() : infoQ.getPreCompNeg();
  byte[] wnafP=WNafUtil.generateWindowNaf(width,k);
  byte[] wnafQ=WNafUtil.generateWindowNaf(width,l);
  return implShamirsTrickWNaf(preCompP,preCompNegP,wnafP,preCompQ,preCompNegQ,wnafQ);
}
