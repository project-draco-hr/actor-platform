{
  conversation(peer).removeItems(JavaUtil.unbox(rids));
  updateChatState(peer);
  Message head=conversation(peer).getHeadValue();
  if (head != null && head.getMessageState() == MessageState.PENDING) {
    head=null;
  }
  return getDialogsRouter().onMessageDeleted(peer,head);
}
