{
  int shiftInv=64 - shift;
  long prev=0;
  int i=count;
  while (--i >= 0) {
    long next=y[yOff + i];
    x[xOff + i]^=(next >>> shift) | prev;
    prev=next << shiftInv;
  }
  return prev;
}
