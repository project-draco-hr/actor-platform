{
  getMenuInflater().inflate(R.menu.avatar,menu);
  DiskCache diskCache=Core.core().getImageLoader().getInternalDiskCache();
  Avatar avatar=getAvatar().getValue();
  String file=avatar == null ? null : diskCache.lockFile(FileKeys.avatarKey(avatar.getFullImage().getFileLocation().getFileId()));
  menu.findItem(R.id.shareAvatar).setVisible(file != null);
  menu.findItem(R.id.setAs).setVisible(file != null);
  if (chatType == DialogType.TYPE_GROUP) {
    menu.findItem(R.id.editAvatar).setVisible(true);
  }
 else {
    menu.findItem(R.id.editAvatar).setVisible(chatId == myUid());
  }
  return true;
}
