{
  if (!curve.equals(p.getCurve())) {
    throw new IllegalStateException();
  }
  BigInteger n=p.getCurve().getOrder();
  BigInteger[] ab=glvEndomorphism.decomposeScalar(k.mod(n));
  BigInteger a=ab[0], b=ab[1];
  ECPointMap pointMap=glvEndomorphism.getPointMap();
  if (glvEndomorphism.hasEfficientPointMap()) {
    return ECAlgorithms.implShamirsTrickWNaf(p,a,pointMap,b);
  }
  return ECAlgorithms.implShamirsTrickWNaf(p,a,pointMap.map(p),b);
}
