{
  super.onResume();
  if (isCompose) {
    messageEditText.requestFocus();
    keyboardUtils.setImeVisibility(messageEditText,true);
  }
  isCompose=false;
  isTypingDisabled=true;
  String text=messenger().loadDraft(peer);
  if (text != null) {
    Spannable spantext=AndroidMarkdown.processOnlyLinks(text);
    spantext=emoji().processEmojiCompatMutable(spantext,SmileProcessor.CONFIGURATION_BUBBLES);
    messageEditText.setText(spantext);
  }
 else {
    messageEditText.setText("");
  }
  messageEditText.setSelection(messageEditText.getText().length());
  isTypingDisabled=false;
}
