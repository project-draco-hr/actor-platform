{
  String str=s.toString();
  String firstPeace=str.substring(0,start + count);
  if (peer.getPeerType() == PeerType.GROUP) {
    if (count == 1 && s.charAt(start) == '@') {
      showMentions(false);
      forceMentionHide=false;
      mentionSearchString="";
      lastMentionSearch="";
    }
 else     if (!forceMentionHide && firstPeace.contains("@")) {
      showMentions(true);
    }
 else {
      hideMentions();
    }
    mentionStart=firstPeace.lastIndexOf("@");
    if (firstPeace.contains("@") && mentionStart + 1 < firstPeace.length()) {
      mentionSearchString=firstPeace.substring(mentionStart + 1,firstPeace.length());
      if (!mentionSearchString.startsWith(MENTION_BOUNDS_STR) && !mentionSearchString.isEmpty())       lastMentionSearch=mentionSearchString;
    }
 else {
      mentionSearchString="";
    }
    if (mentionSearchString.equals(" ")) {
      hideMentions();
    }
 else     if (mentionsAdapter != null) {
      mentionsAdapter.setQuery(mentionSearchString.toLowerCase());
    }
  }
}
