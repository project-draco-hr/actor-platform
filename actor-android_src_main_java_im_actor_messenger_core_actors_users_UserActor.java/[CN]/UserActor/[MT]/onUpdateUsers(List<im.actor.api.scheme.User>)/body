{
  for (  im.actor.api.scheme.User u : users) {
    UserModel model=users().get(u.getId());
    User user;
    if (model == null) {
      user=ApiConversion.convert(u);
    }
 else {
      user=model.getRaw();
      String nName=User.name(u.getLocalName(),u.getName());
      if (!model.getName().equals(nName)) {
        DialogsActor.dialogs().onUserChangedName(u.getId(),nName);
        ContactsActor.contactsList().onUserNameChanged(u.getId());
      }
      Avatar avatar=ApiConversion.convert(u.getAvatar());
      if (!areSame(user.getAvatar(),avatar)) {
        DialogsActor.dialogs().onUserChangedAvatar(u.getId(),avatar);
        ContactsActor.contactsList().onUserAvatarChanged(u.getId());
      }
      user=user.change(u.getName(),u.getLocalName(),avatar,ApiConversion.convert(u.getSex()),u.getKeyHashes());
    }
    users().put(user.getId(),user);
  }
  return result(true);
}
