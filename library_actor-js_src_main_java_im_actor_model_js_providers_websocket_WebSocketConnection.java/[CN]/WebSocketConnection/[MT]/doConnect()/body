{
  isClosed=true;
  String url;
  if (getEndpoint().getType() == ConnectionEndpoint.Type.WS) {
    url="ws://" + getEndpoint().getHost() + ":"+ getEndpoint().getPort()+ "/";
  }
 else   if (getEndpoint().getType() == ConnectionEndpoint.Type.WS_TLS) {
    url="wss://" + getEndpoint().getHost() + ":"+ getEndpoint().getPort()+ "/";
  }
 else {
    throw new RuntimeException();
  }
  Log.d("WS","Connecting to " + url);
  this.jsWebSocket=createJSWebSocket(url,this);
}
