{
  return new Command<AuthState>(){
    @Override public void start(    final CommandCallback<AuthState> callback){
      request(new RequestSignUp(preferences().getLong(KEY_PHONE,0),preferences().getString(KEY_SMS_HASH),preferences().getInt(KEY_SMS_CODE,0) + "",firstName,deviceHash,apiConfiguration.getDeviceTitle(),apiConfiguration.getAppId(),apiConfiguration.getAppKey(),isSilent),new RpcCallback<ResponseAuth>(){
        @Override public void onResult(        ResponseAuth response){
          onLoggedIn(callback,response);
          if (avatarPath != null) {
            modules().getProfile().changeAvatar(avatarPath);
          }
        }
        @Override public void onError(        final RpcException e){
          if ("PHONE_CODE_EXPIRED".equals(e.getTag())) {
            resetAuth();
          }
          runOnUiThread(new Runnable(){
            @Override public void run(){
              callback.onError(e);
            }
          }
);
        }
      }
);
    }
  }
;
}
