{
  isLocked=false;
  long startM=System.currentTimeMillis();
  int index=0;
  for (  ListModification modification1 : modifications) {
    boolean isLast=false;
    if (pending.size() == 0) {
      index++;
      if (index == modifications.length) {
        isLast=true;
      }
    }
    modification1.modify(list.getBackground(),isLast);
  }
  if (ENABLE_LOG) {
    Logger.d("UiList","Modify second phase in " + (System.currentTimeMillis() - startM) + " ms");
    Logger.d("UiList","Switched in " + (System.currentTimeMillis() - starttime) + " ms");
  }
  if (pending.size() > 0) {
    isLocked=true;
    long startPost=System.currentTimeMillis();
    int index2=0;
    for (    ListModification modification : pending) {
      index2++;
      modification.modify(list.getBackground(),index2 == pending.size());
    }
    final ListModification[] listModifications=pending.toArray(new ListModification[pending.size()]);
    pending.clear();
    if (ENABLE_LOG) {
      Logger.d("UiList","Modify second phase/2 in " + (System.currentTimeMillis() - startPost) + " ms");
    }
    final long start=System.currentTimeMillis();
    uiActor.send(new Runnable(){
      @Override public void run(){
        list.switchList();
        self().send(new ListSwitched(start,runnable,listModifications));
      }
    }
);
  }
 else {
    if (runnable != null) {
      runnable.run();
    }
  }
}
