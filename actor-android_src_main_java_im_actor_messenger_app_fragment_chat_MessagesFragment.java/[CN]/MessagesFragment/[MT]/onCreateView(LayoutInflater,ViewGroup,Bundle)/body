{
  peer=Peer.fromUid(getArguments().getLong("CHAT_PEER"));
  listEngine=ListEngines.getMessagesList(peer);
  scrollNewMessage=new TextView(getActivity());
  scrollNewMessage.setTextColor(Color.WHITE);
  scrollNewMessage.setText(R.string.chat_new_messages);
  scrollNewMessage.setBackgroundResource(R.drawable.conv_scroll_down_new);
  scrollNewMessage.setTypeface(Fonts.load(getActivity(),"Regular"));
  scrollNewMessage.setTextSize(14);
  scrollNewMessage.setVisibility(View.GONE);
  scrollUp=new ImageView(getActivity());
  scrollUp.setImageResource(R.drawable.conv_scroll_up);
  scrollDown=new ImageView(getActivity());
  scrollDown.setImageResource(R.drawable.conv_scroll_down);
  messagesView=new RecyclerView(getActivity());
  messagesView.setVerticalScrollBarEnabled(true);
  messagesView.setHorizontalScrollBarEnabled(false);
  messagesView.setHasFixedSize(true);
  LinearLayoutManager linearLayoutManager=new LinearLayoutManager(getActivity());
  linearLayoutManager.setOrientation(LinearLayoutManager.VERTICAL);
  linearLayoutManager.setReverseLayout(true);
  messagesView.setLayoutManager(linearLayoutManager);
  messagesAdapter=new RecyclerMessagesAdapter(this);
  messagesView.setAdapter(messagesAdapter);
  bg=new BackgroundView(getActivity());
  FrameLayout rootLayout=new FrameLayout(getActivity());
  rootLayout.addView(bg,new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.MATCH_PARENT));
  rootLayout.addView(messagesView,new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.MATCH_PARENT));
{
    FrameLayout.LayoutParams params=new FrameLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT,Gravity.RIGHT | Gravity.TOP);
    params.rightMargin=Screen.dp(8);
    params.topMargin=Screen.dp(8);
    rootLayout.addView(scrollUp,params);
  }
{
    FrameLayout.LayoutParams params=new FrameLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT,Gravity.RIGHT | Gravity.BOTTOM);
    params.rightMargin=Screen.dp(8);
    params.bottomMargin=Screen.dp(8);
    rootLayout.addView(scrollDown,params);
  }
{
    FrameLayout.LayoutParams params=new FrameLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT,Gravity.RIGHT | Gravity.BOTTOM);
    params.rightMargin=Screen.dp(8);
    params.bottomMargin=Screen.dp(8);
    rootLayout.addView(scrollNewMessage,params);
  }
  return rootLayout;
}
