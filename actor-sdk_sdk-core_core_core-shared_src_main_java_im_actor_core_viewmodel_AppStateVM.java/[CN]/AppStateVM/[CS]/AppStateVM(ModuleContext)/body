{
  this.context=context;
  this.isDialogsEmpty=new BooleanValueModel("app.dialogs.empty",context.getPreferences().getBool("app.dialogs.empty",true));
  this.isContactsEmpty=new BooleanValueModel("app.contacts.empty",context.getPreferences().getBool("app.contacts.empty",true));
  this.isAppEmpty=new BooleanValueModel("app.empty",context.getPreferences().getBool("app.empty",true));
  this.globalCounter=new IntValueModel("app.counter",null);
  this.globalTempCounter=new IntValueModel("app.temp_counter",0);
  this.isConnecting=new BooleanValueModel("app.connecting",false);
  this.isSyncing=new BooleanValueModel("app.syncing",false);
  this.isAppVisible=new BooleanValueModel("app.visible",false);
  this.isBookImported=context.getPreferences().getBool("app.contacts.imported",false);
  this.isDialogsLoaded=context.getPreferences().getBool("app.dialogs.loaded",false);
  this.isContactsLoaded=context.getPreferences().getBool("app.contacts.loaded",false);
  this.isAppLoaded=new BooleanValueModel("app.loaded",isBookImported && isDialogsLoaded && isContactsLoaded);
  context.getEvents().subscribe(new BusSubscriber(){
    @Override public void onBusEvent(    Event event){
      if (event instanceof AppVisibleChanged) {
        if (((AppVisibleChanged)event).isVisible()) {
          isAppVisible.change(true);
          globalTempCounter.change(0);
        }
 else {
          isAppVisible.change(false);
        }
      }
    }
  }
,AppVisibleChanged.EVENT);
  context.getEvents().subscribe(new BusSubscriber(){
    @Override public void onBusEvent(    Event event){
      isConnecting.change(((ConnectingStateChanged)event).isConnecting());
    }
  }
,ConnectingStateChanged.EVENT);
}
