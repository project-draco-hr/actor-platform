{
  ActorStyle style=ActorSDK.sharedActor().style;
  barView=LayoutInflater.from(this).inflate(R.layout.bar_conversation,null);
  ActionBar.LayoutParams layout=new ActionBar.LayoutParams(ActionBar.LayoutParams.MATCH_PARENT,ActionBar.LayoutParams.MATCH_PARENT);
  setToolbar(barView,layout,false);
  findViewById(R.id.home).setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      onBackPressed();
    }
  }
);
  counter=(TextView)barView.findViewById(R.id.counter);
  counter.setTextColor(style.getDialogsCounterTextColor());
  counter.setBackgroundResource(R.drawable.ic_counter_circle);
  counter.getBackground().setColorFilter(style.getDialogsCounterBackgroundColor(),PorterDuff.Mode.MULTIPLY);
  barTitle=(TextView)barView.findViewById(R.id.title);
  barSubtitleContainer=barView.findViewById(R.id.subtitleContainer);
  barTypingIcon=(ImageView)barView.findViewById(R.id.typingImage);
  barTypingIcon.setImageDrawable(new TypingDrawable());
  barTyping=(TextView)barView.findViewById(R.id.typing);
  barSubtitle=(TextView)barView.findViewById(R.id.subtitle);
  barTypingContainer=barView.findViewById(R.id.typingContainer);
  barTypingContainer.setVisibility(View.INVISIBLE);
  barAvatar=(AvatarView)barView.findViewById(R.id.avatarPreview);
  barAvatar.init(Screen.dp(32),18);
  if (!style.isShowAvatarInTitle() || (peer.getPeerType() == PeerType.PRIVATE && !style.isShowAvatarPrivateInTitle())) {
    barAvatar.setVisibility(View.GONE);
  }
  barView.findViewById(R.id.titleContainer).setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      if (peer.getPeerType() == PeerType.PRIVATE) {
        ActorSDK.sharedActor().startProfileActivity(ChatActivity.this,peer.getPeerId());
      }
 else       if (peer.getPeerType() == PeerType.GROUP) {
        ActorSDK.sharedActor().startGroupInfoActivity(ChatActivity.this,peer.getPeerId());
      }
 else {
      }
    }
  }
);
}
