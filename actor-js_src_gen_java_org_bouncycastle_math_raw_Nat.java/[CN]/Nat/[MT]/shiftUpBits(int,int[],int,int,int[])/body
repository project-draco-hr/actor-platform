{
  for (int i=0; i < len; ++i) {
    int next=x[i];
    z[i]=(next << bits) | (c >>> -bits);
    c=next;
  }
  return c >>> -bits;
}
