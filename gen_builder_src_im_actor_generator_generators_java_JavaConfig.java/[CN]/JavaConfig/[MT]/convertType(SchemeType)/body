{
  if (type instanceof SchemePrimitiveType) {
    return JavaConfig.mapPrimitiveType((SchemePrimitiveType)type);
  }
 else   if (type instanceof SchemeStructType) {
    return getStructName(((SchemeStructType)type).getType());
  }
 else   if (type instanceof SchemeListType) {
    SchemeListType listType=(SchemeListType)type;
    if (listType.getType() instanceof SchemePrimitiveType) {
      return "List<" + mapPrimitiveReferenceType((SchemePrimitiveType)listType.getType()) + ">";
    }
 else     if (listType.getType() instanceof SchemeStructType) {
      return "List<" + getStructName(((SchemeStructType)listType.getType()).getType()) + ">";
    }
 else {
      throw new IOException();
    }
  }
 else   if (type instanceof SchemeOptionalType) {
    SchemeOptionalType optionalType=(SchemeOptionalType)type;
    if (optionalType.getType() instanceof SchemePrimitiveType) {
      return mapPrimitiveReferenceType((SchemePrimitiveType)optionalType.getType());
    }
 else     if (optionalType.getType() instanceof SchemeStructType) {
      return getStructName(((SchemeStructType)optionalType.getType()).getType());
    }
 else     if (optionalType.getType() instanceof SchemeEnumType) {
      return getEnumName(((SchemeEnumType)optionalType.getType()).getName());
    }
 else {
      throw new IOException();
    }
  }
 else   if (type instanceof SchemeEnumType) {
    return getEnumName(((SchemeEnumType)type).getName());
  }
 else {
    throw new IOException();
  }
}
