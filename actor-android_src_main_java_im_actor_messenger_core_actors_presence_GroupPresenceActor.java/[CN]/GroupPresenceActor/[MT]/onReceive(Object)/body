{
  if (message instanceof ConversationOpen) {
    ConversationOpen conv=(ConversationOpen)message;
    if (conv.getType() != DialogType.TYPE_GROUP) {
      return;
    }
    if (presence.contains(conv.getId())) {
      return;
    }
    GroupModel group=groups().get(conv.getId());
    if (group == null) {
      return;
    }
    presence.add(conv.getId());
    List<GroupOutPeer> peers=new ArrayList<GroupOutPeer>();
    peers.add(new GroupOutPeer(group.getChatId(),group.getAccessHash()));
    requests().subscribeToGroupOnline(peers);
  }
 else   if (message instanceof NewSessionCreated) {
    List<GroupOutPeer> peers=new ArrayList<GroupOutPeer>();
    for (    Integer chatId : presence) {
      GroupModel group=groups().get(chatId);
      if (group == null) {
        continue;
      }
      peers.add(new GroupOutPeer(group.getChatId(),group.getAccessHash()));
    }
    if (peers.size() > 0) {
      requests().subscribeToGroupOnline(peers);
    }
  }
 else   if (message instanceof OnGroupOnline) {
    GroupModel group=groups().get(((OnGroupOnline)message).chatId);
    if (group != null) {
      group.updateOnline(((OnGroupOnline)message).count);
    }
  }
}
