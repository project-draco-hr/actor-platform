{
  this.curve=curve;
  this.g=g.normalize();
  this.n=n;
  this.h=h;
  this.seed=seed;
  if (ECAlgorithms.isFpCurve(curve)) {
    this.fieldID=new X9FieldID(curve.getField().getCharacteristic());
  }
 else   if (ECAlgorithms.isF2mCurve(curve)) {
    PolynomialExtensionField field=(PolynomialExtensionField)curve.getField();
    int[] exponents=field.getMinimalPolynomial().getExponentsPresent();
    if (exponents.length == 3) {
      this.fieldID=new X9FieldID(exponents[2],exponents[1]);
    }
 else     if (exponents.length == 5) {
      this.fieldID=new X9FieldID(exponents[4],exponents[1],exponents[2],exponents[3]);
    }
 else {
      throw new IllegalArgumentException("Only trinomial and pentomial curves are supported");
    }
  }
 else {
    throw new IllegalArgumentException("'curve' is of an unsupported type");
  }
}
