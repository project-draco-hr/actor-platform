{
  Log.setLog(configuration.getLog());
  Environment.setThreadingProvider(configuration.getThreadingProvider());
  Environment.setDispatcherProvider(configuration.getDispatcherProvider());
  Timing timing=new Timing("MESSENGER_INIT");
  timing.section("Crypto");
  CryptoUtils.init(configuration.getCryptoProvider());
  timing.section("MVVM");
  MVVMEngine.init(configuration.getMainThreadProvider());
  timing.section("Actors");
  ActorSystem.system().setTraceInterface(new ActorTrace());
  ActorSystem.system().addDispatcher("network");
  ActorSystem.system().addDispatcher("heavy");
  ActorSystem.system().addDispatcher("updates",1);
  if (!configuration.getMainThreadProvider().isSingleThread()) {
    ActorSystem.system().addDispatcher("display_list");
    ActorSystem.system().addDispatcher("db",1);
  }
  timing.section("Modules:Create");
  this.modules=new Modules(this,configuration);
  timing.section("Modules:Run");
  this.modules.run();
  timing.end();
}
