{
  if (request.getApplicationTag() == EACTags.CARDHOLDER_CERTIFICATE) {
    ASN1Sequence seq=ASN1Sequence.getInstance(request.getObject(BERTags.SEQUENCE));
    for (Enumeration en=seq.getObjects(); en.hasMoreElements(); ) {
      DERApplicationSpecific obj=DERApplicationSpecific.getInstance(en.nextElement());
switch (obj.getApplicationTag()) {
case EACTags.CERTIFICATE_CONTENT_TEMPLATE:
        certificateBody=CertificateBody.getInstance(obj);
      valid|=bodyValid;
    break;
case EACTags.STATIC_INTERNAL_AUTHENTIFICATION_ONE_STEP:
  innerSignature=obj.getContents();
valid|=signValid;
break;
default :
throw new IOException("Invalid tag, not an CV Certificate Request element:" + obj.getApplicationTag());
}
}
}
 else {
throw new IOException("not a CARDHOLDER_CERTIFICATE in request:" + request.getApplicationTag());
}
}
