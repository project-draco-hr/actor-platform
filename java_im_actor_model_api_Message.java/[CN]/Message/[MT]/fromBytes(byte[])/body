{
  DataInput input=new DataInput(src,0,src.length);
  int key=input.readVarInt32();
  byte[] content=input.readProtoBytes();
switch (key) {
case 1:
    return Bser.parse(new TextMessage(),content);
case 2:
  return Bser.parse(new ServiceMessage(),content);
case 3:
return Bser.parse(new DocumentMessage(),content);
default :
return new MessageUnsupported(key,content);
}
}
