{
  state=AuthState.LOGGED_IN;
  myUid=response.getUser().getId();
  modules.getPreferences().putBool(KEY_AUTH,true);
  modules.getPreferences().putInt(KEY_AUTH_UID,myUid);
  modules.onLoggedIn(true);
  modules.getUsersModule().getUsersStorage().addOrUpdateItem(new User(response.getUser()));
  modules.getUpdatesModule().onUpdateReceived(new LoggedIn(response,new Runnable(){
    @Override public void run(){
      state=AuthState.LOGGED_IN;
      callback.onResult(state);
    }
  }
));
}
