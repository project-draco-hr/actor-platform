{
  this.configuration=configuration;
  this.i18nEngine=new I18nEngine(configuration.getLocaleProvider());
  this.preferences=configuration.getStorage().createPreferencesStorage();
  this.actorApi=new ActorApi(new Endpoints(configuration.getEndpoints()),new PreferenceApiStorage(preferences),new ActorApiCallback(){
    @Override public void onAuthIdInvalidated(    long authKey){
    }
    @Override public void onNewSessionCreated(){
      if (updates != null) {
        updates.onNewSessionCreated();
      }
      if (presence != null) {
        presence.onNewSessionCreated();
      }
    }
    @Override public void onUpdateReceived(    Object obj){
      if (updates != null) {
        updates.onUpdateReceived(obj);
      }
    }
  }
,configuration.getNetworking());
  this.auth=new Auth(this);
}
