{
  webSocket=new WebSocket(url,new WebSocketCallback(){
    @Override public void onOpen(){
      if (!isCreated) {
        isCreated=true;
        factoryCallback.onConnectionCreated(WebSocketConnection.this);
      }
 else {
      }
    }
    @Override public void onClose(){
      if (!isCreated) {
        isCreated=true;
        factoryCallback.onConnectionCreateError();
      }
 else {
        callback.onConnectionDie();
      }
    }
    @Override public void onMessage(    byte[] message){
      if (isCreated && !isClosed) {
        callback.onMessage(message,0,message.length);
      }
    }
  }
);
}
