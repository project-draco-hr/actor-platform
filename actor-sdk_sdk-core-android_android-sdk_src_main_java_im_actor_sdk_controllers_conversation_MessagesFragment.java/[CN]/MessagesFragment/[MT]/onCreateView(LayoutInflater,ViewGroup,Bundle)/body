{
  try {
    peer=Peer.fromBytes(getArguments().getByteArray("EXTRA_PEER"));
    conversationVM=messenger().getConversationVM(peer);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  View res=inflate(inflater,container,R.layout.fragment_messages,onCreateDisplayList());
  if (wallpaperPrefs == null) {
    wallpaperPrefs=getContext().getSharedPreferences("wallpaper",Context.MODE_PRIVATE);
  }
  Drawable background;
  if (messenger().getSelectedWallpaper() == null) {
    background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[0]);
  }
 else   if (messenger().getSelectedWallpaper().equals("local:bg_1")) {
    if (ActorSDK.sharedActor().style.getDefaultBackgrouds().length > 1) {
      background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[1]);
    }
 else {
      background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[0]);
    }
  }
 else   if (messenger().getSelectedWallpaper().equals("local:bg_2")) {
    if (ActorSDK.sharedActor().style.getDefaultBackgrouds().length > 2) {
      background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[2]);
    }
 else {
      background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[0]);
    }
  }
 else   if (messenger().getSelectedWallpaper().equals("local:bg_3")) {
    if (ActorSDK.sharedActor().style.getDefaultBackgrouds().length > 3) {
      background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[3]);
    }
 else {
      background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[0]);
    }
  }
 else   if (messenger().getSelectedWallpaper().startsWith("local:")) {
    background=getResources().getDrawable(ActorSDK.sharedActor().style.getDefaultBackgrouds()[0]);
  }
 else {
    background=Drawable.createFromPath(BaseActorSettingsFragment.getWallpaperFile());
  }
  ((ImageView)res.findViewById(R.id.chatBackgroundView)).setImageDrawable(background);
  View footer=new View(getActivity());
  footer.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,Screen.dp(8)));
  addHeaderView(footer);
  View header=new View(getActivity());
  header.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,Screen.dp(64)));
  addFooterView(header);
  bindDisplayListLoad();
  return res;
}
