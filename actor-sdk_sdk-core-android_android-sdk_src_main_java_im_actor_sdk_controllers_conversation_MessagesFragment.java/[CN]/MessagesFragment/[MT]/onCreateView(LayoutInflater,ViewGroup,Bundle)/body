{
  try {
    peer=Peer.fromBytes(getArguments().getByteArray("EXTRA_PEER"));
    conversationVM=messenger().getConversationVM(peer);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  View res=inflate(inflater,container,R.layout.fragment_messages,onCreateDisplayList());
  if (wallpaperPrefs == null) {
    wallpaperPrefs=getContext().getSharedPreferences("wallpaper",Context.MODE_PRIVATE);
  }
  Drawable background;
  int[] backgrounds=ActorSDK.sharedActor().style.getDefaultBackgrouds();
  String selectedWallpaper=messenger().getSelectedWallpaper();
  if (selectedWallpaper != null) {
    if (backgrounds.length > 0) {
      background=getResources().getDrawable(backgrounds[0]);
      if (selectedWallpaper.startsWith("local")) {
        for (int i=1; i < backgrounds.length; i++) {
          if (getResources().getResourceEntryName(backgrounds[i]).equals(selectedWallpaper.replaceAll("local:",""))) {
            background=getResources().getDrawable(backgrounds[i]);
          }
        }
      }
 else {
        background=Drawable.createFromPath(BaseActorSettingsFragment.getWallpaperFile());
      }
      ((ImageView)res.findViewById(R.id.chatBackgroundView)).setImageDrawable(background);
    }
  }
  View footer=new View(getActivity());
  footer.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,Screen.dp(8)));
  addHeaderView(footer);
  View header=new View(getActivity());
  header.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,Screen.dp(64)));
  addFooterView(header);
  bindDisplayListLoad();
  return res;
}
