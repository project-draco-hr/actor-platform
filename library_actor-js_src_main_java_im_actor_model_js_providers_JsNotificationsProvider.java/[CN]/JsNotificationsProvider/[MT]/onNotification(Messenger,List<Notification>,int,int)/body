{
  Notification notification=topNotifications.get(0);
  String contentMessage=messenger.getFormatter().formatContentDialogText(notification.getSender(),notification.getContentDescription().getContentType(),notification.getContentDescription().getText(),notification.getContentDescription().getRelatedUser());
  String peerTitle;
  Avatar peerAvatar;
  if (notification.getPeer().getPeerType() == PeerType.PRIVATE) {
    UserVM userVM=messenger.getUsers().get(notification.getPeer().getPeerId());
    peerTitle=userVM.getName().get();
    peerAvatar=userVM.getAvatar().get();
  }
 else {
    GroupVM groupVM=messenger.getGroups().get(notification.getPeer().getPeerId());
    peerTitle=groupVM.getName().get();
    peerAvatar=groupVM.getAvatar().get();
    contentMessage=messenger.getUsers().get(notification.getSender()).getName().get() + ": " + contentMessage;
  }
  String peerAvatarUrl=null;
  if (peerAvatar != null && peerAvatar.getSmallImage() != null) {
    peerAvatarUrl=((JsMessenger)messenger).getFileUrl(peerAvatar.getSmallImage().getFileReference());
  }
  if (currentNotification != null) {
    currentNotification.close();
    currentNotification=null;
  }
  if (!JsNotification.isSupported()) {
    return;
  }
  if (!JsNotification.isGranted()) {
    return;
  }
  currentNotification=JsNotification.create(peerTitle,contentMessage,peerAvatarUrl);
  playSound();
}
