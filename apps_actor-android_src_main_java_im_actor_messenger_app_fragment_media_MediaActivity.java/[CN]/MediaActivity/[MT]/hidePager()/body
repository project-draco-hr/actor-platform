{
  Message media=displayList.getItem(selectedIndex);
  transitionImageView.setAlpha(1f);
  transitionImageView.setExtraReceiverCallback(new ReceiverCallback(){
    @Override public void onImageLoaded(    BitmapReference bitmap){
      toolbar.setTitle(R.string.media);
      showingPager=false;
      viewPager.setAlpha(0);
      viewPager.setVisibility(View.GONE);
      int firstVisiblePosition=((GridLayoutManager)recyclerView.getLayoutManager()).findFirstVisibleItemPosition();
      View selectedView=recyclerView.getChildAt(selectedIndex - firstVisiblePosition);
      int[] location=new int[2];
      selectedView.getLocationInWindow(location);
      transitionImageView.setExtraReceiverCallback(null);
      MediaFullscreenAnimationUtils.animateBack(transitionImageView,bitmap.getBitmap(),location[0],location[1],selectedView.getWidth(),selectedView.getHeight(),new AnimatorListenerAdapter(){
        @Override public void onAnimationEnd(        Animator animation){
          invalidateOptionsMenu();
          transitionImageView.clear();
          transitionImageView.setAlpha(0f);
          transitionBackgroundView.setAlpha(0f);
          transitionBackgroundView.setOnClickListener(null);
          viewPager.setAdapter(null);
        }
      }
);
      MediaFullscreenAnimationUtils.animateBackgroundBack(transitionBackgroundView);
      viewPager.setAlpha(0);
      goneView(viewPager,false);
    }
    @Override public void onImageCleared(){
      Log.d("Media Activity","cleared");
    }
    @Override public void onImageError(){
      Log.d("Media Activity","error");
    }
  }
);
  final DocumentContent document=(DocumentContent)media.getContent();
  if (document.getSource() instanceof FileRemoteSource) {
    FileRemoteSource remoteSource=(FileRemoteSource)document.getSource();
    final FileReference location=remoteSource.getFileReference();
    messenger().requestState(location.getFileId(),new DownloadCallback(){
      @Override public void onNotDownloaded(){
      }
      @Override public void onDownloading(      float progress){
      }
      @Override public void onDownloaded(      final FileSystemReference reference){
        MVVMEngine.runOnUiThread(new Runnable(){
          @Override public void run(){
            transitionImageView.post(new Runnable(){
              @Override public void run(){
                transitionImageView.request(new RawFileTask(reference.getDescriptor()));
              }
            }
);
          }
        }
);
      }
    }
);
    Logger.d("MediaActivity","Remote =(");
  }
 else   if (document.getSource() instanceof FileLocalSource) {
    final String path=((FileLocalSource)document.getSource()).getFileDescriptor();
    transitionImageView.request(new RawFileTask(path));
  }
}
