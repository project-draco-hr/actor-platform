{
switch (event.getAction()) {
case MotionEvent.ACTION_DOWN:
    touchX=event.getX();
  touchY=event.getY();
return true;
case MotionEvent.ACTION_UP:
float slop=ViewConfiguration.get(getContext()).getScaledTouchSlop();
if (Math.abs(event.getX() - touchX) < slop && Math.abs(event.getY() - touchY) < slop) {
int offsetLeft=(getWidth() - countInRow * smileySize) / 2;
if (touchX > offsetLeft || touchX < offsetLeft + smileySize * countInRow) {
int row=(int)(touchY / smileySize);
int col=(int)((touchX - offsetLeft) / smileySize);
int index=row * countInRow + col;
if (index >= 0 && index < smileyIds.length) {
  if (onEmojiClickListener != null) {
    playSoundEffect(SoundEffectConstants.CLICK);
    onEmojiClickListener.onEmojiClicked(smileyIds[index]);
  }
}
}
}
return true;
}
return false;
}
