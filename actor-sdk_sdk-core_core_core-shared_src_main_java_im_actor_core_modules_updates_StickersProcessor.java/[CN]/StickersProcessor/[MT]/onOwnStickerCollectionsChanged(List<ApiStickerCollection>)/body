{
  ArrayList<StickersPack> add=new ArrayList<StickersPack>();
  ArrayList<StickersPack> remove=new ArrayList<StickersPack>();
  for (int i=0; i < stickerPacksList().getCount(); i++) {
    remove.add(stickerPacksList().getValue(i));
  }
  for (  ApiStickerCollection pack : updated) {
    add.add(new StickersPack(pack));
  }
  boolean needrebuild=false;
  if (add.size() > 0) {
    stickerPacksList().addOrUpdateItems(add);
    stickerPacksKeyValue().addOrUpdateItems(add);
    needrebuild=true;
  }
  if (remove.removeAll(add)) {
    for (    StickersPack pack : remove) {
      stickerPacksList().removeItem(pack.getEngineId());
      stickerPacksKeyValue().removeItem(pack.getEngineId());
    }
    needrebuild=true;
  }
  if (needrebuild) {
    context().getEvents().post(new Event(){
      @Override public String getType(){
        return "sticker_collections_changed";
      }
    }
);
  }
}
