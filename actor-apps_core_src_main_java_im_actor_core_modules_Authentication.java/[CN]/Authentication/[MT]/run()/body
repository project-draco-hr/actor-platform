{
  if (modules.getPreferences().getBool(KEY_AUTH,false)) {
    state=AuthState.LOGGED_IN;
    modules.onLoggedIn();
    User user=modules.getUsersModule().getUsersStorage().getValue(myUid);
    ArrayList<Long> records=new ArrayList<Long>();
    for (    ContactRecord contactRecord : user.getRecords()) {
      if (contactRecord.getRecordType() == ContactRecordType.PHONE) {
        records.add(Long.parseLong(contactRecord.getRecordData()));
      }
    }
    modules.getAnalyticsModule().onLoggedIn(Crypto.hex(deviceHash),user.getUid(),records.toArray(new Long[records.size()]),user.getName());
  }
 else {
    state=AuthState.AUTH_START;
    modules.getAnalyticsModule().onLoggedOut(Crypto.hex(deviceHash));
  }
}
