{
  for (  ActorExtension e : scope.getActor().getExtensions()) {
    e.postStop();
  }
  scope.getActor().postStop();
  scope.onActorDie();
  for (  Envelope e : scope.getMailbox().allEnvelopes()) {
    if (e.getSender() != null) {
      e.getSender().send(new DeadLetter(e.getMessage()));
    }
  }
  scope.getMailbox().clear();
synchronized (LOCK) {
    scopes.remove(scope.getPath());
    endpoints.remove(scope.getPath());
    dispatcher.getQueue().disconnectMailbox(scope.getMailbox());
  }
}
