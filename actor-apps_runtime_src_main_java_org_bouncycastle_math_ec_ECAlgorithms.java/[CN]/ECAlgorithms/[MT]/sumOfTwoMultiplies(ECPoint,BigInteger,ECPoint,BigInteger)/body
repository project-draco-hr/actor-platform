{
  ECCurve cp=P.getCurve();
  Q=importPoint(cp,Q);
  if (cp instanceof ECCurve.F2m) {
    ECCurve.F2m f2mCurve=(ECCurve.F2m)cp;
    if (f2mCurve.isKoblitz()) {
      return validatePoint(P.multiply(a).add(Q.multiply(b)));
    }
  }
  ECEndomorphism endomorphism=cp.getEndomorphism();
  if (endomorphism instanceof GLVEndomorphism) {
    return validatePoint(implSumOfMultipliesGLV(new ECPoint[]{P,Q},new BigInteger[]{a,b},(GLVEndomorphism)endomorphism));
  }
  return validatePoint(implShamirsTrickWNaf(P,a,Q,b));
}
