{
  boolean negK=k.signum() < 0, negL=l.signum() < 0;
  k=k.abs();
  l=l.abs();
  int widthP=Math.max(2,Math.min(16,WNafUtil.getWindowSize(k.bitLength())));
  int widthQ=Math.max(2,Math.min(16,WNafUtil.getWindowSize(l.bitLength())));
  WNafPreCompInfo infoP=WNafUtil.precompute(P,widthP,true);
  WNafPreCompInfo infoQ=WNafUtil.precompute(Q,widthQ,true);
  ECPoint[] preCompP=negK ? infoP.getPreCompNeg() : infoP.getPreComp();
  ECPoint[] preCompQ=negL ? infoQ.getPreCompNeg() : infoQ.getPreComp();
  ECPoint[] preCompNegP=negK ? infoP.getPreComp() : infoP.getPreCompNeg();
  ECPoint[] preCompNegQ=negL ? infoQ.getPreComp() : infoQ.getPreCompNeg();
  byte[] wnafP=WNafUtil.generateWindowNaf(widthP,k);
  byte[] wnafQ=WNafUtil.generateWindowNaf(widthQ,l);
  return implShamirsTrickWNaf(preCompP,preCompNegP,wnafP,preCompQ,preCompNegQ,wnafQ);
}
