{
  DataInput bis=new DataInput(data,offset,len);
  try {
    long authId=bis.readLong();
    long sessionId=bis.readLong();
    if (authId != this.authId || sessionId != this.sessionId) {
      throw new IOException("Incorrect header");
    }
    long messageId=bis.readLong();
    byte[] payload=bis.readProtoBytes();
    receiver.send(new ProtoMessage(messageId,payload));
  }
 catch (  IOException e) {
    Log.w(TAG,"Closing connection: incorrect package");
    e.printStackTrace();
    if (currentConnection != null) {
      currentConnection.close();
      currentConnection=null;
      currentConnectionId=0;
    }
    checkConnection();
  }
}
