{
  PendingMessage msg=findPending(rid);
  if (msg == null) {
    return;
  }
  pendingMessages.getPendingMessages().remove(msg);
  AbsContent nContent;
  if (msg.getContent() instanceof PhotoContent) {
    PhotoContent basePhotoContent=(PhotoContent)msg.getContent();
    nContent=new PhotoContent(new FileRemoteSource(fileReference),basePhotoContent.getMimetype(),basePhotoContent.getName(),basePhotoContent.getFastThumb(),basePhotoContent.getW(),basePhotoContent.getH());
  }
 else   if (msg.getContent() instanceof VideoContent) {
    VideoContent baseVideoContent=(VideoContent)msg.getContent();
    nContent=new VideoContent(new FileRemoteSource(fileReference),baseVideoContent.getMimetype(),baseVideoContent.getName(),baseVideoContent.getFastThumb(),baseVideoContent.getDuration(),baseVideoContent.getW(),baseVideoContent.getH());
  }
 else   if (msg.getContent() instanceof DocumentContent) {
    DocumentContent baseDocContent=(DocumentContent)msg.getContent();
    nContent=new DocumentContent(new FileRemoteSource(fileReference),baseDocContent.getMimetype(),baseDocContent.getName(),baseDocContent.getFastThumb());
  }
 else {
    return;
  }
  pendingMessages.getPendingMessages().add(new PendingMessage(msg.getPeer(),msg.getRid(),nContent));
  getConversationActor(msg.getPeer()).send(new ConversationActor.MessageContentUpdated(msg.getRid(),nContent));
  performSendContent(msg.getPeer(),rid,nContent);
}
