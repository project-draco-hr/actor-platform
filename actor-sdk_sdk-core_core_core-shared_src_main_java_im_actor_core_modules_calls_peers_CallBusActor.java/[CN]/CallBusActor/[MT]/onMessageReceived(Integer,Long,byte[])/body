{
  if (senderId == null || senderDeviceId == null) {
    return;
  }
  deviceIds.put(senderDeviceId,senderId);
  ApiWebRTCSignaling signal;
  try {
    signal=ApiWebRTCSignaling.fromBytes(data);
  }
 catch (  IOException e) {
    e.printStackTrace();
    return;
  }
  Log.d("CallBusActor","Message Received: " + signal);
  if (signal instanceof ApiAnswer) {
    ApiAnswer answer=(ApiAnswer)signal;
    peerCall.onAnswer(senderDeviceId,answer.getSdp());
  }
 else   if (signal instanceof ApiOffer) {
    ApiOffer offer=(ApiOffer)signal;
    peerCall.onAdvertised(senderDeviceId,new PeerSettings(offer.getOwnPeerSettings()));
    peerCall.onOffer(senderDeviceId,offer.getSdp());
  }
 else   if (signal instanceof ApiCandidate) {
    ApiCandidate candidate=(ApiCandidate)signal;
    peerCall.onCandidate(senderDeviceId,candidate.getIndex(),candidate.getId(),candidate.getSdp());
  }
 else   if (signal instanceof ApiNeedOffer) {
    ApiNeedOffer needOffer=(ApiNeedOffer)signal;
    deviceIds.put(needOffer.getDevice(),needOffer.getUid());
    peerCall.onAdvertised(needOffer.getDevice(),new PeerSettings(needOffer.getPeerSettings()));
    peerCall.onOfferNeeded(needOffer.getDevice());
  }
 else   if (signal instanceof ApiOnAnswer) {
    ApiOnAnswer onAnswer=(ApiOnAnswer)signal;
    deviceIds.put(onAnswer.getDevice(),onAnswer.getUid());
    peerCall.onTheirStarted(onAnswer.getDevice());
  }
 else   if (signal instanceof ApiNeedDisconnect) {
    ApiNeedDisconnect disconnect=(ApiNeedDisconnect)signal;
    deviceIds.put(disconnect.getDevice(),disconnect.getUid());
    peerCall.disposePeer(disconnect.getDevice());
  }
 else   if (signal instanceof ApiSwitchMaster) {
    if (isMasterReady || isMasterMode) {
      return;
    }
    isMasterReady=true;
    masterUid=senderId;
    masterDeviceId=senderDeviceId;
    unstashAll(STASH);
    sendSignal(masterUid,masterDeviceId,new ApiAdvertiseSelf(selfSettings.toApi()));
    peerCall.onTheirStarted(masterDeviceId);
  }
 else   if (signal instanceof ApiAdvertiseSelf) {
    ApiAdvertiseSelf advertiseSelf=(ApiAdvertiseSelf)signal;
    if (peerSettings.containsKey(senderDeviceId)) {
      return;
    }
    PeerSettings settings=new PeerSettings(advertiseSelf.getPeerSettings());
    peerSettings.put(senderDeviceId,settings);
    peerCall.onAdvertised(senderDeviceId,settings);
    if (isAnswered.contains(senderDeviceId)) {
      callBusCallback.onAnswered(senderId,senderDeviceId);
    }
  }
 else   if (signal instanceof ApiAnswerCall) {
    if (isAnswered.contains(senderDeviceId)) {
      return;
    }
    isAnswered.add(senderDeviceId);
    if (peerSettings.containsKey(senderDeviceId)) {
      callBusCallback.onAnswered(senderId,senderDeviceId);
    }
  }
}
