{
  Q=Q.normalize();
  ECFieldElement x=Q.getAffineXCoord();
  byte[] bytes=x.getEncoded();
  if (!x.isZero()) {
    ECFieldElement z=Q.getAffineYCoord().divide(x);
    if (trace(z).isOne()) {
      bytes[bytes.length - 1]|=0x01;
    }
 else {
      bytes[bytes.length - 1]&=0xFE;
    }
  }
  return bytes;
}
