{
  Long collectionKey=sortedCollection.isEmpty() ? null : sortedCollection.firstKey();
  if (collectionKey != null) {
    EnvelopeCollection collection=sortedCollection.get(collectionKey);
    EnvelopeCollection.FetchResult envelope=collection.fetchEnvelope(time);
    if (envelope != null) {
      if (envelope.getEnvelope() != null) {
        detachCollection(collection);
        FetchResult result=FetchResult.envelope(envelope.getEnvelope().getEnvelope());
        envelope.recycle();
        return result;
      }
 else {
        FetchResult result=FetchResult.delay(envelope.getDelay());
        envelope.recycle();
        return result;
      }
    }
 else {
      return null;
    }
  }
 else {
    return null;
  }
}
