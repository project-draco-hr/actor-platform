{
  ArrayList<DialogHistory> dialogs=new ArrayList<DialogHistory>();
  long maxLoadedDate=Long.MAX_VALUE;
  for (  ApiDialog dialog : dialogsResponse.getDialogs()) {
    maxLoadedDate=Math.min(dialog.getSortDate(),maxLoadedDate);
    Peer peer=convert(dialog.getPeer());
    AbsContent msgContent=AbsContent.fromMessage(dialog.getMessage());
    if (msgContent == null) {
      continue;
    }
    dialogs.add(new DialogHistory(peer,dialog.getUnreadCount(),dialog.getSortDate(),dialog.getRid(),dialog.getDate(),dialog.getSenderUid(),msgContent,dialog.getState() == ApiMessageState.READ,dialog.getState() == ApiMessageState.RECEIVED));
  }
  if (dialogs.size() > 0) {
    dialogsActor().send(new DialogsActor.HistoryLoaded(dialogs));
  }
 else {
    context().getAppStateModule().onDialogsLoaded();
  }
  dialogsHistoryActor().send(new DialogsHistoryActor.LoadedMore(dialogsResponse.getDialogs().size(),maxLoadedDate));
}
