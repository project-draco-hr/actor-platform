{
  HashSet<Integer> users=new HashSet<Integer>();
  HashSet<Integer> groups=new HashSet<Integer>();
  HashSet<Integer> contacts=new HashSet<Integer>();
  if (update instanceof UpdateMessage) {
    UpdateMessage updateMessage=(UpdateMessage)update;
    users.add(updateMessage.getSenderUid());
    if (updateMessage.getPeer().getType() == PeerType.GROUP) {
      groups.add(updateMessage.getPeer().getId());
    }
    if (updateMessage.getPeer().getType() == PeerType.PRIVATE) {
      users.add(updateMessage.getPeer().getId());
    }
  }
 else   if (update instanceof UpdateEncryptedMessage) {
    UpdateEncryptedMessage updateMessage=(UpdateEncryptedMessage)update;
    users.add(updateMessage.getSenderUid());
    if (updateMessage.getPeer().getType() == PeerType.GROUP) {
      groups.add(updateMessage.getPeer().getId());
    }
    if (updateMessage.getPeer().getType() == PeerType.PRIVATE) {
      users.add(updateMessage.getPeer().getId());
    }
  }
 else   if (update instanceof UpdateContactRegistered) {
    UpdateContactRegistered contactRegistered=(UpdateContactRegistered)update;
    users.add(contactRegistered.getUid());
  }
 else   if (update instanceof UpdateGroupInvite) {
    UpdateGroupInvite groupInvite=(UpdateGroupInvite)update;
    users.add(groupInvite.getInviteUid());
    groups.add(groupInvite.getGroupId());
  }
 else   if (update instanceof UpdateGroupUserAdded) {
    UpdateGroupUserAdded added=(UpdateGroupUserAdded)update;
    users.add(added.getInviterUid());
    users.add(added.getUid());
    groups.add(added.getGroupId());
  }
 else   if (update instanceof UpdateGroupUserKick) {
    UpdateGroupUserKick kick=(UpdateGroupUserKick)update;
    users.add(kick.getKickerUid());
    users.add(kick.getUid());
    groups.add(kick.getGroupId());
  }
 else   if (update instanceof UpdateGroupUserLeave) {
    UpdateGroupUserLeave leave=(UpdateGroupUserLeave)update;
    users.add(leave.getUid());
    groups.add(leave.getGroupId());
  }
 else   if (update instanceof UpdateContactsAdded) {
    users.addAll(((UpdateContactsAdded)update).getUids());
  }
 else   if (update instanceof UpdateContactsRemoved) {
    users.addAll(((UpdateContactsRemoved)update).getUids());
  }
 else   if (update instanceof UpdateUserContactAdded) {
    UpdateUserContactAdded contactAdded=(UpdateUserContactAdded)update;
    users.add(contactAdded.getUid());
    contacts.add(contactAdded.getContactId());
  }
 else   if (update instanceof UpdateUserContactRemoved) {
    UpdateUserContactRemoved contactAdded=(UpdateUserContactRemoved)update;
    users.add(contactAdded.getUid());
    contacts.add(contactAdded.getContactId());
  }
 else   if (update instanceof UpdateUserLocalNameChanged) {
    UpdateUserLocalNameChanged localNameChanged=(UpdateUserLocalNameChanged)update;
    users.add(localNameChanged.getUid());
  }
  if (!usersProcessor.hasUsers(users)) {
    return true;
  }
  if (!groupsProcessor.hasGroups(groups)) {
    return true;
  }
  return false;
}
