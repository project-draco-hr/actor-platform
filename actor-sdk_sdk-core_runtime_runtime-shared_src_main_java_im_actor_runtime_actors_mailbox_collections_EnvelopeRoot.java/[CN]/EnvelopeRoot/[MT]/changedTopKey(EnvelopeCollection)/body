{
  Log.d("EnvelopeRoot","changedTopKey (" + collection.getTopKey() + ") #"+ collection.getId());
  if (!collections.containsKey(collection.getId())) {
    Log.d("EnvelopeRoot","changedTopKey - ignored");
    return;
  }
  long key=collection.getTopKey();
  Long prevKey=lastTopKey.get(collection.getId());
  lastTopKey.remove(collection.getId());
  if (prevKey > 0) {
    sortedCollection.remove(prevKey);
  }
  lastTopKey.put(collection.getId(),key);
  if (key > 0) {
    sortedCollection.put(key,collection);
  }
  queue.notifyQueueChanged();
}
