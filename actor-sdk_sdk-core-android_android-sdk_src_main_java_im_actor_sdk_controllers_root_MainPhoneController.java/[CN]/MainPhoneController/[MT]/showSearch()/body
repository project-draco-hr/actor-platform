{
  if (isSearchVisible) {
    return;
  }
  isSearchVisible=true;
  searchDisplay=messenger().buildSearchDisplayList();
  searchAdapter=new SearchAdapter(getActivity(),searchDisplay,new OnItemClickedListener<SearchEntity>(){
    @Override public void onClicked(    SearchEntity item){
      startActivity(Intents.openDialog(item.getPeer(),false,getActivity()));
    }
    @Override public boolean onLongClicked(    SearchEntity item){
      return false;
    }
  }
);
  HeaderViewRecyclerAdapter recyclerAdapter=new HeaderViewRecyclerAdapter(searchAdapter);
  View header=new View(getActivity());
  header.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,Screen.dp(0)));
  header.setBackgroundColor(ActorSDK.sharedActor().style.getMainBackgroundColor());
  recyclerAdapter.addHeaderView(header);
  TextView footerTitle=new TextView(getActivity());
  footerTitle.setText(R.string.main_search_global_header);
  footerTitle.setTextSize(16);
  footerTitle.setPadding(Screen.dp(12),Screen.dp(8),0,Screen.dp(8));
  footerTitle.setBackgroundColor(ActorSDK.sharedActor().style.getBackyardBackgroundColor());
  footerTitle.setTextColor(ActorSDK.sharedActor().style.getTextSecondaryColor());
  footerSearchHolder=new SearchHolder(getActivity(),new OnItemClickedListener<SearchEntity>(){
    @Override public void onClicked(    SearchEntity item){
      int peerId=item.getPeer().getPeerId();
      getActivity().execute(messenger().addContact(peerId),R.string.progress_common,new CommandCallback<Boolean>(){
        @Override public void onResult(        Boolean res2){
          startActivity(Intents.openPrivateDialog(peerId,true,getActivity()));
        }
        @Override public void onError(        Exception e){
          startActivity(Intents.openPrivateDialog(peerId,true,getActivity()));
        }
      }
);
    }
    @Override public boolean onLongClicked(    SearchEntity item){
      return false;
    }
  }
);
  View footerGlobalSearchView=footerSearchHolder.itemView;
  footer=new LinearLayout(getActivity());
  footer.setOrientation(LinearLayout.VERTICAL);
  LinearLayout.LayoutParams params=new LinearLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.WRAP_CONTENT);
  footer.addView(footerTitle,params);
  footer.addView(footerGlobalSearchView,params);
  footer.setVisibility(View.GONE);
  recyclerAdapter.addFooterView(footer);
  searchList.setAdapter(recyclerAdapter);
  searchDisplay.addListener(searchListener);
  onHideToolbarCustomView();
  showView(searchHintView,false);
  goneView(searchEmptyView,false);
  showView(searchContainer);
}
