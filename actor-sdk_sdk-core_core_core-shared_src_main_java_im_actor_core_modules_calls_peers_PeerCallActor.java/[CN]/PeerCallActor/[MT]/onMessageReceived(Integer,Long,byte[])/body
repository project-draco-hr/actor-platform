{
  if (senderId == null || senderDeviceId == null) {
    return;
  }
  ApiWebRTCSignaling signaling;
  try {
    signaling=ApiWebRTCSignaling.fromBytes(data);
  }
 catch (  IOException e) {
    e.printStackTrace();
    Log.d(TAG,"onMessageReceived:ignoring");
    return;
  }
  Log.d(TAG,"onMessageReceived: " + signaling);
  if (signaling instanceof ApiSwitchMaster) {
    onMasterSwitched(senderId,senderDeviceId);
  }
 else   if (signaling instanceof ApiOffer) {
    ApiOffer offer=(ApiOffer)signaling;
    getPeer(senderId,senderDeviceId).onAdvertised(new PeerNodeSettings(offer.getOwnPeerSettings()));
    getPeer(senderId,senderDeviceId).onOffer(offer.getSdp());
  }
 else   if (signaling instanceof ApiAnswer) {
    ApiAnswer answer=(ApiAnswer)signaling;
    getPeer(senderId,senderDeviceId).onAnswer(answer.getSdp());
  }
 else   if (signaling instanceof ApiCandidate) {
    ApiCandidate candidate=(ApiCandidate)signaling;
    getPeer(senderId,senderDeviceId).onCandidate(candidate.getIndex(),candidate.getId(),candidate.getSdp());
  }
 else   if (signaling instanceof ApiNeedOffer) {
    ApiNeedOffer needOffer=(ApiNeedOffer)signaling;
    getPeer(needOffer.getUid(),needOffer.getDevice()).onOfferNeeded();
  }
 else   if (signaling instanceof ApiAdvertiseSelf) {
    ApiAdvertiseSelf advertiseSelf=(ApiAdvertiseSelf)signaling;
    onAdvertised(senderId,senderDeviceId,advertiseSelf.getPeerSettings());
  }
 else   if (signaling instanceof ApiAnswerCall) {
    onAnswered(senderId,senderDeviceId);
  }
}
