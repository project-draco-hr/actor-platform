{
  boolean isUpdated=currentMessage == null || currentMessage.getRid() != message.getRid();
  currentMessage=message;
  container.setBubbleSelected(fragment.isSelected(currentMessage.getRid()));
  boolean useDiv;
  if (pos == 0) {
    useDiv=true;
  }
 else {
    MessageModel prevMessage=uiList.getItem(uiList.getSize() - pos);
    useDiv=!TextUtils.areSameDays(prevMessage.getRaw().getTime(),message.getRaw().getTime());
  }
  if (useDiv) {
    container.showDate(message.getRaw().getTime());
  }
 else {
    container.hideDate();
  }
  if (!isFullSize) {
    if (message.isOut()) {
      container.makeOutboundBubble();
    }
 else {
      container.makeInboundBubble(fragment.getChatType() == DialogType.TYPE_GROUP,message.getRaw().getSenderId());
    }
  }
  if (message.getRid() == fragment.getFirstUnread()) {
    container.showUnread();
  }
 else {
    container.hideUnread();
  }
  update(message,pos,isUpdated,context);
  fragment.onItemViewed(message);
}
