{
  boolean isUpdated=currentMessage == null || currentMessage.getRid() != message.getRid();
  currentMessage=message;
  container.setBubbleSelected(fragment.isSelected(currentMessage.getRid()));
  boolean useDiv;
  if (pos == 0) {
    useDiv=true;
  }
 else {
    Message prevMessage=uiList.getItem(uiList.getSize() - pos);
    useDiv=!TextUtils.areSameDays(prevMessage.getDate(),message.getDate());
  }
  if (useDiv) {
    container.showDate(message.getDate());
  }
 else {
    container.hideDate();
  }
  if (!isFullSize) {
    if (message.getSenderId() == myUid()) {
      container.makeOutboundBubble();
    }
 else {
      container.makeInboundBubble(peer.getPeerType() == PeerType.GROUP,message.getSenderId());
    }
  }
  if (message.getRid() == fragment.getFirstUnread()) {
    container.showUnread();
  }
 else {
    container.hideUnread();
  }
  update(message,pos,isUpdated,context);
  fragment.onItemViewed(message);
}
