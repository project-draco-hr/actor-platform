{
  byte[] resBuf=new byte[digest.getDigestSize()];
  for (int i=0; i < 65536; i++) {
    digest.update((byte)(i & 0xff));
  }
  digest.doFinal(resBuf,0);
  if (!areEqual(resBuf,Hex.decode(expected))) {
    fail("64k test failed",expected,new String(Hex.encode(resBuf)));
  }
}
