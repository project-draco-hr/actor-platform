{
  if (avatar != null && avatar.getSmallImage() != null && avatar.getSmallImage().getFileReference().getFileId() == currentId) {
    return;
  }
  if (fileVM != null) {
    fileVM.detach();
    fileVM=null;
  }
  if (fullFileVM != null) {
    fullFileVM.detach();
    fullFileVM=null;
  }
  isLoaded=false;
  if (setCommon(avatar))   return;
  if (avatar != null && avatar.getSmallImage() != null) {
    currentId=avatar.getSmallImage().getFileReference().getFileId();
    fileVM=messenger().bindFile(avatar.getSmallImage().getFileReference(),true,new FileVMCallback(){
      @Override public void onNotDownloaded(){
      }
      @Override public void onDownloading(      float progress){
      }
      @Override public void onDownloaded(      FileSystemReference reference){
        isSmallLoaded=true;
        if (!isLoaded) {
          setImageURI(Uri.fromFile(new File(reference.getDescriptor())));
        }
      }
    }
);
    if (avatar.getFullImage() != null) {
      fullFileVM=messenger().bindFile(avatar.getFullImage().getFileReference(),true,new FileVMCallback(){
        @Override public void onNotDownloaded(){
        }
        @Override public void onDownloading(        float progress){
        }
        @Override public void onDownloaded(        FileSystemReference reference){
          isLoaded=true;
          if (bkgrnd != null && avatar != null && (avatar.getSmallImage() != null)) {
            String downloadedDescriptor=messenger().getDownloadedDescriptor(avatar.getSmallImage().getFileReference().getFileId());
            if (downloadedDescriptor != null && !downloadedDescriptor.isEmpty()) {
              Drawable d=Drawable.createFromPath(downloadedDescriptor);
              bkgrnd.setImageDrawable(d);
            }
          }
          setImageURI(Uri.fromFile(new File(reference.getDescriptor())));
        }
      }
);
    }
  }
}
