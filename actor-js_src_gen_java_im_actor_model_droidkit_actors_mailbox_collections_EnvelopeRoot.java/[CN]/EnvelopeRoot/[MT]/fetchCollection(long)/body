{
  Map.Entry<Long,EnvelopeCollection> res=sortedCollection.isEmpty() ? null : sortedCollection.firstEntry();
  if (res != null) {
    EnvelopeCollection collection=res.getValue();
    EnvelopeCollection.FetchResult envelope=collection.fetchEnvelope(time);
    if (envelope != null) {
      if (envelope.getEnvelope() != null) {
        detachCollection(collection);
        FetchResult result=FetchResult.envelope(envelope.getEnvelope().getEnvelope());
        envelope.recycle();
        return result;
      }
 else {
        FetchResult result=FetchResult.delay(envelope.getDelay());
        envelope.recycle();
        return result;
      }
    }
 else {
      return null;
    }
  }
 else {
    return null;
  }
}
