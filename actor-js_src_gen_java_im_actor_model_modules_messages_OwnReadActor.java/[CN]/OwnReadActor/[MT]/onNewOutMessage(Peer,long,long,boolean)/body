{
  Set<UnreadMessage> unread=messagesStorage.getUnread(peer);
  long maxPlainReadDate=0;
  for (  UnreadMessage u : unread) {
    if (u.isEncrypted()) {
    }
 else {
      maxPlainReadDate=Math.max(u.getSortDate(),maxPlainReadDate);
    }
  }
  unread.clear();
  if (maxPlainReadDate > 0) {
    modules().getMessagesModule().getPlainReadActor().send(new PlainReaderActor.MarkRead(peer,maxPlainReadDate));
  }
  modules().getMessagesModule().saveReadState(peer,sortingDate);
  modules().getMessagesModule().getDialogsActor().send(new DialogsActor.CounterChanged(peer,0));
}
